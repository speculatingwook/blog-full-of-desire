---
title: '스프링 어노테이션, 객체 정리'
date: '2023-05-07'
tags: ['spring']
draft: false
summary: 스프링에 쓰이는 어노테이션, 객체 정리
---

## 정리를 하게 된 계기

요즘 스프링을 공부할 때 잘 짜시는 분의 코드를 깃허브에서 긁어와서 분석하면서 적용하고 있다. 그래서 그런지 나도 모르는 어노테이션을 적용하는 경우가 많았다. 그래서 그분의 코드를 제 프로젝트에 적용하면서 어노테이션을 적용하는 이유를 정리해가면서 사용하려고 한다.

## 스프링의 어노테이션(annotation)이란?

어노테이션이란 자바 코드에 추가적인 정보를 제공하는 메타데이터(metadata)이다. 어노테이션을 사용하여 클래스, 메소드, 변수 등에 대한 정보를 표현하고, 이 정보를 프로그램에서 활용할 수 있다.

어노테이션은 `@` 기호로 시작하며, 컴파일러나 프레임워크 등에서 이 정보를 읽어 활용할 수 있다. 예를 들어, 스프링(Spring) 프레임워크에서는 `@Controller`, `@Service`, `@Repository` 등의 어노테이션을 사용하여 스프링이 해당 클래스를 어떻게 활용해야 하는지를 나타내며, 이 정보를 바탕으로 스프링 컨테이너가 빈(bean)을 생성하고 관리할 수 있다.

어노테이션은 사용자가 직접 정의할 수도 있으며, 이러한 사용자 정의 어노테이션을 사용하면 해당 어노테이션이 적용된 요소에 대한 추가적인 정보를 제공할 수 있다. 이를 통해 개발자는 코드를 더욱 명확하게 작성할 수 있고, 다른 개발자들이 코드를 이해하기 쉬워진다.

## ResponseEntity 객체

스프링(Spring)에서는 `ResponseEntity`를 사용하여 HTTP 응답(Response)을 생성할 수 있다. `ResponseEntity`는 HTTP 응답 본문(body), 상태 코드(status code), 응답 헤더(response headers) 등을 포함할 수 있으며, 클라이언트에게 전송될 응답을 정의할 때 사용한다.

`ResponseEntity`는 제네릭 클래스로, 응답 본문의 타입을 명시할 수 있다. 예를 들어, `ResponseEntity<String>`은 String 타입의 응답 본문을 포함하는 HTTP 응답을 나타낸다.

`ResponseEntity`의 주요 메소드는 다음과 같다.

- `getBody()` : 응답 본문을 반환한다.
- `getStatusCode()` : 응답 상태 코드를 반환한다.
- `getHeaders()` : 응답 헤더를 반환한다.

`ResponseEntity`를 사용하면 HTTP 응답에 대한 세밀한 제어가 가능해지며, RESTful API를 개발할 때 유용하다. 예를 들어, 클라이언트에서 요청한 데이터가 없는 경우 404 Not Found 상태 코드와 함께 응답을 반환하거나, 클라이언트의 요청이 잘못된 경우 400 Bad Request 상태 코드와 함께 응답을 반환할 수 있다.

### `created()`

네, `ResponseEntity`에는 `created`라는 정적 메소드가 있습니다. `created` 메소드는 HTTP 201 Created 상태 코드와 함께 리소스 생성 요청에 대한 응답을 생성할 때 사용됩니다.

`created` 메소드의 구문

```java
public static <T> ResponseEntity<T> created(URI location)
```

- `T` : 응답 본문의 타입을 나타낸다.
- `location` : 생성된 리소스의 위치를 나타내는 URI를 전달한다.

예를 들어, 다음 코드는 `created` 메소드를 사용하여 HTTP 201 Created 상태 코드와 함께 새로운 리소스를 생성하는 응답을 생성하는 방법을 보여준다.

```java
@PostMapping("/users")
public ResponseEntity<User> createUser(@RequestBody User user) {
    // 새로운 유저를 생성하고, 생성된 유저를 location URI에 추가힌다.
    User createdUser = userService.createUser(user);
    URI location = ServletUriComponentsBuilder
                        .fromCurrentRequest()
                        .path("/{id}")
                        .buildAndExpand(createdUser.getId())
                        .toUri();
    // HTTP 201 Created 상태 코드와 생성된 유저를 반환한다.
    return ResponseEntity.created(location).body(createdUser);
}
```

위 코드에서는 새로운 유저를 생성하고, 생성된 유저를 나타내는 URI를 `location` 변수에 저장한다. 그리고 `created` 메소드를 사용하여 HTTP 201 Created 상태 코드와 함께 해당 URI를 반환한다. 반환된 `ResponseEntity`의 본문으로는 생성된 유저 객체가 포함된다.

## ServletUriComponentsBuilder 클래스

`ServletUriComponentsBuilder`는 Spring에서 제공하는 URI 빌더 클래스로, Servlet 기반의 애플리케이션에서 사용된다. `ServletUriComponentsBuilder`를 사용하면 현재 요청(Request)에 대한 URI를 쉽게 생성할 수 있다.

`ServletUriComponentsBuilder`의 `fromCurrentRequest()` 메소드는 현재 요청(Request)의 정보를 기반으로 URI를 생성한다. 예를 들어, 현재 요청의 URL과 파라미터 등의 정보를 이용하여 URI를 생성할 수 있다. 또한 `path()` 메소드를 사용하여 URI 경로를 추가하고, `queryParam()` 메소드를 사용하여 URI 쿼리 파라미터를 추가할 수 있다.

예를 들어, 다음 코드는 `ServletUriComponentsBuilder`를 사용하여 현재 요청(Request)에 대한 URI를 생성하는 방법을 보여준다.

```java
@GetMapping("/users/{id}")
public ResponseEntity<User> getUser(@PathVariable Long id) {
    // 사용자 정보를 조회하고, 조회된 사용자 정보를 반환한다.
    User user = userService.getUser(id);
    return ResponseEntity.ok(user);
}

@PostMapping("/users")
public ResponseEntity<User> createUser(@RequestBody User user) {
    // 새로운 유저를 생성하고, 생성된 유저를 반환한다.
    User createdUser = userService.createUser(user);
    // 생성된 유저의 정보가 포함된 URI를 생성합니다.
    URI location = ServletUriComponentsBuilder
                        .fromCurrentRequest()
                        .path("/{id}")
                        .buildAndExpand(createdUser.getId())
                        .toUri();
    // HTTP 201 Created 상태 코드와 생성된 유저를 반환한다.
    return ResponseEntity.created(location).body(createdUser);
}
```

위 코드에서는 `ServletUriComponentsBuilder`를 사용하여 새로운 유저를 생성한 후, 생성된 유저를 반환할 때 생성된 유저의 정보가 포함된 URI를 생성한다. 생성된 URI는 `created` 메소드의 인자로 전달된다.
